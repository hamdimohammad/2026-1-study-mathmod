---
## Author
author:
  name: Хамди Мохаммад
  email: 1032235868@rudn.ru
  affiliation:
    - name: Российский университет дружбы народов
      country: Российская Федерация
      postal-code: 117198
      city: Москва
      address: ул. Миклухо-Маклая, д. 6

## Title
title: "Математическое моделирование"
subtitle: "Лабораторная работа № 2"
license: "CC BY"
---

# Цель работы

Рассмотрим пример построения математической модели, позволяющей выбрать рациональную стратегию поиска и преследования.  
В качестве иллюстрации возьмём задачу о погоне: в условиях тумана катер береговой охраны преследует лодку браконьеров. Спустя некоторое время туман рассеивается, и лодка фиксируется на расстоянии $k$ км от катера. Далее лодка снова скрывается в тумане и продолжает движение прямолинейно в неизвестном направлении. Известно, что скорость катера в $n$ раз больше скорости лодки.  
Требуется определить траекторию движения катера, обеспечивающую перехват.

# Задание

1. Выполнить рассуждения и вывести дифференциальные уравнения при условии, что скорость катера превышает скорость лодки в $n$ раз.
2. Построить траектории движения катера и лодки для двух вариантов начального положения.
3. По графику определить точку встречи катера и лодки.

# Выполнение лабораторной работы

Положим $t_0=0$. За точку отсчёта примем место обнаружения лодки.  
Пусть в момент обнаружения лодка находится в точке $X_0=0$, а катер — на расстоянии $k$ от лодки (то есть относительно полюса катер расположен на радиусе, связанном с расстоянием $k$).

Далее перейдём к полярным координатам. Полюс — точка обнаружения лодки, а полярная ось $r$ направлена через положение катера в момент обнаружения.

## Нахождение расстояния $x$

Обозначим через $x$ расстояние от полюса, на котором катер должен выйти на “равный радиус” с лодкой и перейти к обходной траектории.

Пусть через время $t$ катер и лодка окажутся на одинаковом расстоянии $x$ от полюса. За это время лодка проходит путь $x$, а катер — $x+k$ (или $x-k$, если считать начальное положение по другую сторону относительно выбранного направления оси).

Время движения лодки: $t=\frac{x}{v}$.  
Время движения катера: $t=\frac{x+k}{nv}$ (для первого случая) или $t=\frac{x-k}{nv}$ (для второго случая).

Приравнивая времена, получаем:

- **Случай 1 (plus):** $\frac{x}{v}=\frac{x+k}{nv}$
- **Случай 2 (minus):** $\frac{x}{v}=\frac{x-k}{nv}$

Отсюда находятся два значения начального радиуса:

$x_1=\frac{k}{n+1}$ при $\theta=0$

$x_2=\frac{k}{n-1}$ при $\theta=-\pi$

## Разложение скорости и вывод системы ОДУ

После того как катер окажется на том же расстоянии от полюса, что и лодка, он должен прекратить прямолинейное движение и начать обход вокруг полюса, одновременно удаляясь от него с той же радиальной скоростью, что и лодка, то есть $v$.

Разложим скорость катера на компоненты:

- радиальная компонента $v_r=\frac{dr}{dt}$,
- тангенциальная компонента $v_t=r\frac{d\theta}{dt}$.

Требование “держать равный радиальный темп” задаём как
$v_r=\frac{dr}{dt}=v$.

Поскольку полная скорость катера равна $nv$, то по теореме Пифагора:
$(nv)^2=v_r^2+v_t^2$.

Подставляя $v_r=v$, получаем:
$v_t = v\sqrt{n^2-1}$.

Следовательно,
$r\frac{d\theta}{dt}=v\sqrt{n^2-1}$.

Итак, исходная задача сводится к системе:

$$
\begin{cases}
\frac{dr}{dt}=v, \\
r\frac{d\theta}{dt}=v\sqrt{n^2-1}.
\end{cases}
$$

### Начальные условия

Для двух вариантов:

$$
\begin{cases}
\theta_0=0, \\
r_0=\frac{k}{n+1}.
\end{cases}
$$

$$
\begin{cases}
\theta_0=-\pi, \\
r_0=\frac{k}{n-1}.
\end{cases}
$$

Исключая параметр $t$, получаем уравнение траектории катера:

$\frac{dr}{d\theta}=\frac{r}{\sqrt{n^2-1}}$.

С прежними начальными условиями решение этого уравнения задаёт траекторию катера в полярных координатах. Далее выполним построение траекторий катера и лодки для двух случаев.

## Условие задачи

На море в условиях тумана катер береговой охраны преследует лодку браконьеров.  
Через некоторое время туман рассеивается, и лодка обнаруживается на расстоянии 20 км от катера. Затем лодка снова скрывается и продолжает прямолинейное движение в неизвестном направлении.  
Скорость катера в 5 раз выше скорости лодки.

Для моделирования процесса и построения графиков использовались внешние файлы с программным кодом:

{{< include ../project/markdown/01_task_of_chase/01_task_of_chase.qmd >}}

{{< include ../project/markdown/02_task_of_chase/02_task_of_chase.qmd >}}

## Анализ результатов моделирования

В рамках работы проведено численное исследование движения катера, описываемого уравнением

$$
\frac{dr}{d\theta}=\frac{r}{\sqrt{n^2-1}},
$$

а также выполнено сопоставление с траекторией лодки, заданной аналитически (прямолинейное движение в декартовой системе) и представленной в полярных координатах.

## Базовые эксперименты

### 1. Случай (case = plus)

![Базовый эксперимент (case=plus)](image/single_experiment.png)

По полярному графику видно, что катер движется по расходящейся спирали: при росте угла $\theta$ радиус $r$ увеличивается монотонно. Поскольку $dr/d\theta$ пропорциональна $r$, зависимость носит экспоненциальный характер по углу.

Лодка при прямолинейном движении в декартовой системе соответствует лучу в полярной системе (радиус растёт согласованно с параметром движения).

На графике заметно, что катер увеличивает радиус быстрее, чем лодка, поэтому расстояние между кривыми возрастает.

### 2. Случай (case = minus)

![Базовый эксперимент (case=minus)](image/single_experiment_minus.png)

Во втором сценарии начальное значение радиуса больше, поэтому стартовая точка катера находится дальше от полюса. Форма траектории сохраняется (та же спираль), но вся кривая “сдвинута наружу” из-за другого начального условия.

Отличие между режимами case=plus и case=minus определяется именно стартовым радиусом и общим масштабом траектории; качественный характер роста остаётся одинаковым.

## Параметрическое сканирование по $n$

![Сканирование траекторий катера](image/parametric_scan_cutter_comparison.png)

Исследовано влияние параметра $n$ на динамику системы в обоих режимах начальных условий.

Из уравнения следует, что коэффициент роста равен $1/\sqrt{n^2-1}$. При увеличении $n$ он уменьшается, поэтому:

- при меньших $n$ спираль расходится быстрее;
- при больших $n$ рост радиуса замедляется;
- траектории становятся более “пологими”.

На графике наиболее быстрый рост соответствует $n=3$, а наиболее медленный — $n=10$.

## Анализ метрики scale_ratio

![Зависимость scale_ratio от n](image/scale_ratio_vs_n.png)

Введена метрика

$$
\text{scale\_ratio}=\frac{r_{\text{final}}}{\max(r_{\text{boat}})}.
$$

Она отражает, насколько “крупнее” по масштабу оказывается траектория катера относительно траектории лодки.

По графику видно:

- при малых $n$ метрика заметно больше 1 — катер значительно опережает лодку по радиальному росту;
- при увеличении $n$ значение быстро падает;
- при больших $n$ масштабы траекторий становятся ближе.

Для режима case=minus метрика выше, что объясняется большим стартовым радиусом.

## Время вычислений

![Зависимость времени вычисления от n](image/computation_time_vs_n.png)

Проведён бенчмаркинг численного решения ОДУ при различных $n$.

Наблюдения:

- время вычисления порядка $6\times 10^{-4}$ секунды;
- выраженной зависимости от $n$ не выявлено;
- небольшие колебания связаны с адаптивным шагом интегрирования и особенностями численной процедуры.

# Выводы

1. Траектория катера в полярных координатах имеет вид экспоненциально расходящейся спирали.
2. Параметр $n$ регулирует скорость радиального роста: чем больше $n$, тем медленнее увеличивается $r$ по углу $\theta$.
3. Выбор начального условия (case) влияет на масштаб траектории, но не меняет её качественную форму.
4. Численное решение устойчиво, а вычислительная нагрузка слабо зависит от параметров модели.

Полученные результаты согласуются с аналитической структурой уравнения $dr/d\theta$.

# Список литературы {.unnumbered}

1. [Задача о погоне](https://esystem.rudn.ru/pluginfile.php/2290141/mod_resource/content/2/Лабораторная%20работа%20№%201.pdf)
