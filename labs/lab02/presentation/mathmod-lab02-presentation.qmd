---
## Author
author:
  name: Хамди Мохаммад
  email: 1032235868@rudn.ru
  affiliation:
    - name: Российский университет дружбы народов
      country: Российская Федерация
      postal-code: 117198
      city: Москва
      address: ул. Миклухо-Маклая, д. 6

## Title
title: "Математическое моделирование"
subtitle: "Лабораторная работа № 2"
license: "CC BY"
date: today
date-format: "YYYY-MM-DD"
---

# Вводная часть

## Цель работы

Показать, как с помощью математического моделирования можно обосновать стратегию поиска/преследования и получить траекторию, ведущую к перехвату.

Сюжет: в тумане катер береговой охраны преследует лодку браконьеров. В момент краткого прояснения лодка фиксируется на расстоянии $k$ км от катера, затем снова скрывается и уходит по прямой в неизвестном направлении. Известно, что скорость катера в $n$ раз больше скорости лодки. Требуется определить траекторию катера, обеспечивающую встречу.

## Задание

1. Провести рассуждения и получить дифференциальные уравнения для случая, когда скорость катера превосходит скорость лодки в $n$ раз.
2. Построить траектории катера и лодки для двух вариантов начальных условий.
3. По графикам определить точку пересечения траекторий (момент перехвата).

# Теория: постановка и вывод модели

## Начальные обозначения и координаты

Положим $t_0 = 0$.

В момент обнаружения:

- лодка находится в точке $X_0 = 0$,
- катер расположен на расстоянии $k$ от лодки (вдоль выбранного направления).

Переходим к полярным координатам:

- полюс — точка обнаружения лодки,
- ось $r$ направим через начальное положение катера.

## Дистанция перехода к «обходу» полюса

Ищем расстояние $x$, при котором катер и лодка оказываются на одном и том же радиусе относительно полюса.

За время $t$:

- лодка проходит $x$,
- катер проходит $x-k$ или $x+k$ (в зависимости от того, как задана начальная конфигурация относительно полюса).

## Разложение скорости катера и система ОДУ

Приравнивая времена и учитывая, что скорость катера равна $nv$, получаем два режима начальных условий:

- **case = plus**:
  $$
  x_1=\frac{k}{n+1}, \quad \theta_0=0
  $$
- **case = minus**:
  $$
  x_2=\frac{k}{n-1}, \quad \theta_0=-\pi
  $$

После выхода на общий радиус катер должен:

- удаляться от полюса с радиальной скоростью, равной скорости лодки $v$,
- одновременно иметь тангенциальную составляющую, чтобы «обметать» направления.

Скорость раскладываем на компоненты:

- $v_r=\frac{dr}{dt}$,
- $v_t=r\frac{d\theta}{dt}$,

причём $v_r=v$, а по Пифагору для полной скорости $nv$:
$$(nv)^2=v_r^2+v_t^2 \;\Rightarrow\; v_t=v\sqrt{n^2-1}.$$

Отсюда система:
$$
\frac{dr}{dt}=v,\qquad r\frac{d\theta}{dt}=v\sqrt{n^2-1}.
$$

## Уравнение траектории катера

Исключая $t$, получаем:
$$
\frac{dr}{d\theta}=\frac{r}{\sqrt{n^2-1}}.
$$

Вывод по виду решения: в полярных координатах траектория катера является расходящейся (экспоненциальной по углу) спиралью.

# Эксперимент: численное моделирование

## Условие задачи для расчётов

Дано:

- расстояние обнаружения: $k=20$ км,
- скорость катера выше в $n=5$ раз.

Цель: построить траектории катера и лодки и по их пересечению определить момент перехвата.

## Базовый эксперимент: case = plus

![](image/single_experiment.png)

## Базовый эксперимент: case = plus

Наблюдения:

- траектория катера — расходящаяся спираль;
- радиус $r$ увеличивается при росте угла $\theta$;
- траектория лодки в полярных координатах соответствует лучу (так как в декартовой системе движение прямолинейное).

## Базовый эксперимент: case = minus

![](image/single_experiment_minus.png)

## Базовый эксперимент: case = minus

Ключевые отличия от case=plus:

- начальный радиус больше, поэтому стартовая точка расположена дальше от полюса;
- форма спирали сохраняется, но меняется общий масштаб (траектория «вынесена» наружу).

# Параметрический анализ

## Сканирование по параметру $n$

![](image/parametric_scan_cutter_comparison.png)

## Сканирование по параметру $n$

Из уравнения
$$
\frac{dr}{d\theta}=\frac{r}{\sqrt{n^2-1}}
$$
видно, что коэффициент роста по углу равен $1/\sqrt{n^2-1}$. Следовательно:

- при малых $n$ спираль расходится быстрее;
- при больших $n$ рост радиуса становится более медленным;
- траектории выглядят более «пологими».

## Метрика scale_ratio

Введём показатель:
$$
\text{scale\_ratio}=\frac{r_{\text{final}}}{\max(r_{\text{boat}})}.
$$

## Метрика scale_ratio

![](image/scale_ratio_vs_n.png)

## Метрика scale_ratio

Интерпретация:

- при малых $n$ метрика существенно больше 1 — радиальный масштаб траектории катера заметно превышает масштаб лодки;
- с ростом $n$ метрика быстро уменьшается;
- при больших $n$ траектории становятся ближе по масштабу.

Для режима case=minus значения выше из-за большего стартового радиуса.

## Время вычислений

![](image/computation_time_vs_n.png)

## Время вычислений

Результаты бенчмаркинга:

- время расчёта порядка $6\times10^{-4}$ сек;
- явной зависимости от $n$ не выявлено;
- небольшие колебания объясняются адаптивным шагом интегрирования.

# Итоги

## Выводы

1. Траектория катера в полярной системе координат имеет вид экспоненциально расходящейся спирали.
2. Параметр $n$ задаёт темп роста: чем больше $n$, тем медленнее увеличивается радиус при росте $\theta$.
3. Начальный режим (case) меняет масштаб траектории, но не её качественную форму.
4. Численное решение устойчиво, а вычислительные затраты практически не зависят от $n$.
